import itertools
import numpy as np
from scipy.spatial import Voronoi
import arcpy
import shapely.geometry
import shapely.ops
from shapely.wkt import loads
import shapely.prepared
from ponto_circ_borda import PtCircBorda
linha_wkt ="MULTILINESTRING((-52.66039565299996639 -2.90882468799992466, -52.66045202399993741 -2.90881272799992985, -52.66053384499997492 -2.90880256499997358, -52.66060237599998572 -2.90880115399994565, -52.66062139199993908 -2.90880076099995222, -52.6606387769999742 -2.90878845999992564, -52.66070067399994059 -2.90873537299995633, -52.66084953699993321 -2.90860677699993175, -52.66091254899993146 -2.90855296799998086, -52.66100526899998613 -2.90848704899997301, -52.66107319799994002 -2.90842979699993975, -52.66114412799993261 -2.90836135499995407, -52.6612169449999783 -2.90829059799995093, -52.66125869199993303 -2.90824968699996589, -52.66127607599997873 -2.90822785999995403, -52.6613115249999737 -2.9081506669999726, -52.66131470999994235 -2.90814249499993593, -52.66138628799996013 -2.90798613499993053), (-52.66138628799996013 -2.90798613499993053, -52.66137159499993459 -2.9079607519999513, -52.66132926499994937 -2.90789613399994096, -52.66129562099996519 -2.90785075299993423, -52.66122896799993214 -2.9077603579999618, -52.66113444999996318 -2.90763456599995607, -52.66107121599998209 -2.90756086199996844, -52.66101307899998574 -2.90750257999997075, -52.66098376999997299 -2.90747740599994131, -52.66093653199993696 -2.90743823899993004, -52.66090450899997677 -2.90740302599994038, -52.66088830599994708 -2.90738041799994562, -52.66080233599996063 -2.90727969499994288, -52.66074510899994721 -2.90721596099996304, -52.66068789599995625 -2.90715221999994355, -52.66066073499996492 -2.90711215699997183, -52.66061786599993866 -2.9070611949999261, -52.66056549799998265 -2.90698236399992993, -52.66052846599995974 -2.90690967999995564, -52.66051553099993043 -2.90687508499996738, -52.66049507999997559 -2.90683481899992557, -52.66048205899994628 -2.90680017699997961, -52.66044692399998439 -2.90672578699997075, -52.66040940399994952 -2.90665213799996991, -52.66037188399997149 -2.90657848999995849, -52.6603305839999507 -2.90649692399995274, -52.66030659199998354 -2.90643807399993648, -52.66030397699995547 -2.90642897399993672, -52.66027761399993778 -2.90636180699993929, -52.66027497999994011 -2.90635267399994746, -52.66024863599994887 -2.90628553899995268, -52.66024598299998161 -2.90627637499994762, -52.66022838999998612 -2.90623153199993567, -52.66022149099995886 -2.9062077599999725, -52.66019953399995757 -2.90612925699997504, -52.66017688899995619 -2.90604838199993765, -52.66015281899996126 -2.90596342499992488, -52.66012835899994116 -2.90588563899996188, -52.66010379299996202 -2.90580788199997642, -52.66008497599995053 -2.90574996599997348, -52.66007575599996926 -2.90572669499994163, -52.66006002799997532 -2.90567236799995499, -52.66003041099997972 -2.90559645999996974, -52.66000079499997355 -2.90552055199992765, -52.65997117799997795 -2.90544464299995298, -52.65994132699995589 -2.90536792999995441, -52.65991132299996025 -2.90529041299993196, -52.65988191999997525 -2.90521441299995331, -52.65985251799997968 -2.90513841299997466, -52.65982082699997591 -2.90506322699997099, -52.65979287199996861 -2.90499283499997318, -52.65976137399997015 -2.90495152799996958, -52.65971815199998218 -2.90488246599994682, -52.6596851639999386 -2.90483371999994233, -52.65966156999996883 -2.90480287999997699, -52.65963894299994763 -2.90476666099993963, -52.65960710299998482 -2.90472508199997037, -52.65959169199993539 -2.9047003899999595, -52.65955982599996332 -2.90465879499993207, -52.65954443999993373 -2.90463411999996879, -52.65951254899994183 -2.90459250799995061, -52.65949718899997833 -2.90456784999997808, -52.65946527199997718 -2.90452622099996915, -52.6594499379999661 -2.9045015789999411, -52.65939918399993758 -2.90443798899997319, -52.65934954199997264 -2.90437354799996683, -52.6592935999999554 -2.90431392899995444, -52.65925847899995915 -2.90428300999997191, -52.65922366499995633 -2.90425772199995436, -52.65919998199996144 -2.90423693899992941, -52.65915896699993937 -2.90420709299996815, -52.65913515099998676 -2.90418626499996435, -52.65909426799993298 -2.90415646499997138, -52.65907032199993409 -2.90413559099994245, -52.6590034859999605 -2.90408679499995515, -52.65893157699997573 -2.90404274999997369, -52.6588593399999354 -2.90399901299997509, -52.65878208799995264 -2.90395997199993872, -52.65867261699997925 -2.90391426999997293), (-52.66242406699996081 -2.90785071599992762, -52.66239508199993224 -2.9078495239999711, -52.66230721399995218 -2.90784989499996982, -52.66223535099993569 -2.90785785599996416, -52.66219612599996935 -2.90786647399994536, -52.66215224299997999 -2.90787159899997505, -52.66203499599993165 -2.90789715299996487, -52.66194732599996087 -2.90792285499992431, -52.66187086499996894 -2.90794665799995755, -52.66184051799996269 -2.90794895299995915, -52.66175503699997762 -2.90796185299996068, -52.66170312199994896 -2.90796598499997572, -52.66166481999994176 -2.9079716439999288, -52.6615753369999311 -2.90797885999995742, -52.66145353699994303 -2.90798107099993786, -52.66138628799996013 -2.90798613499993053), (-52.65677879599996913 -2.90544293499993955, -52.656794141999967 -2.90538636599995925, -52.65681808999994473 -2.90532614999995076, -52.65684034699995664 -2.90527784199997541, -52.65685526699996899 -2.90526274299998022, -52.65690940799993314 -2.90520187899994653, -52.65696354999994355 -2.90514101599995911, -52.65701658299997234 -2.9050792699999306, -52.65704743699996015 -2.90505198299996437, -52.65707409599997391 -2.9050210879999554, -52.65710956599997417 -2.90498961599996619, -52.65713227299994514 -2.90496343499995646, -52.65716761499993481 -2.904931979999958, -52.6571904489999838 -2.90490577899993241, -52.65722566599993115 -2.90487434599992866, -52.65725394899993717 -2.90484203899995919, -52.6572859869999661 -2.90481961299997238, -52.65735271199997669 -2.90477306799994039, -52.65741943699993044 -2.90472652199997583, -52.65748616199994103 -2.90467997699994385, -52.65755180799993695 -2.90463418699994236, -52.65757486099994367 -2.90462208099995678, -52.65761214699995207 -2.9045959749999497, -52.65768266499998163 -2.9045567939999728, -52.65775573399997711 -2.90451590999992959, -52.65781551699996044 -2.90449371799996925, -52.65789114299997209 -2.90446299799992858, -52.65792376399997465 -2.90444566599995824, -52.65796564799995849 -2.90443018699994582, -52.65804110999994236 -2.90438988499994366, -52.65810363299993924 -2.90435822299997426, -52.65812990799997806 -2.90434853199997178, -52.65820166799994695 -2.90431023899992624, -52.65826888799995231 -2.90426179199994294, -52.65837730799995597 -2.90416042899994409, -52.65840639199996076 -2.90413833899992824, -52.65849618499993312 -2.90405475599993679, -52.65857780099997854 -2.90398789099992882, -52.65863500699998667 -2.90394305099994199, -52.65867261699997925 -2.90391426999997293), (-52.65867261699997925 -2.90391426999997293, -52.65862265799995612 -2.90372332999993432, -52.6586070379999569 -2.90364182499996559, -52.65859291099997108 -2.90357345899997199, -52.6585711469999751 -2.90349420499995858, -52.6585441649999666 -2.90341717599994809, -52.65850891499997033 -2.90332111199995779, -52.65847885799996675 -2.90329376999994793, -52.65843763699996316 -2.90326219199994284, -52.65837458099997548 -2.90320440799996504, -52.65824002299996209 -2.90307845599994607, -52.65819291299993665 -2.90303813399992805, -52.6581184059999714 -2.90298297899994395, -52.65805455199995322 -2.90293265999997629, -52.65799416799995925 -2.90287750799996047, -52.65798845099993741 -2.90287113399995178, -52.65793428899996798 -2.90282165099995382, -52.65792848299997786 -2.90281520899992529, -52.65791143199993485 -2.90279962699997895, -52.65789750699997285 -2.90278915299995788, -52.65786979899996822 -2.9027722189999281, -52.65784188799995036 -2.90275121799993485, -52.65778514599998061 -2.90269754099995225, -52.65776730999994015 -2.90266745599996057, -52.65772547899996425 -2.90259586499996658, -52.65770243199995093 -2.90255382699996289, -52.65767897599994285 -2.90250092099995527, -52.65766159299994342 -2.90247232599995186, -52.65762949699995943 -2.90239856999994572, -52.65761322499997732 -2.90237260299994659, -52.65754953699996577 -2.90222540099995285, -52.6575167809999698 -2.90215083399994001, -52.65748461799995539 -2.90207882899994729, -52.6574496729999737 -2.90199680099993884, -52.65742060499997024 -2.90193417599994063, -52.65739587699994217 -2.90189639299995861, -52.65738136999993912 -2.90186261499997045, -52.6573502459999645 -2.90181494899997006, -52.65734025399996199 -2.90179192799996599, -52.65730923899997151 -2.90174427899995635, -52.6572991399999637 -2.90172123899992584, -52.65725541499995188 -2.90165386299997863, -52.65724079899996468 -2.90163757699997404, -52.65721026199997823 -2.90159095799992883, -52.65718470599995271 -2.9015695129999699, -52.65716008899994449 -2.90155439199998, -52.65712908999995534 -2.90152837899995575, -52.65709414499997365 -2.90150693399993997, -52.65706560299997818 -2.90148295499994902, -52.65702791599994725 -2.90145985399993833, -52.65698173299995233 -2.90142099899992445, -52.65696383699997796 -2.90140992199997072, -52.65690339999997605 -2.90135869799996726, -52.6568699389999324 -2.90132063899994819, -52.65682039099993972 -2.90124246099992433, -52.65677555899998197 -2.90117150499997933, -52.65673072899994622 -2.9011005469999418, -52.65669757099993831 -2.90104953799993837, -52.65668921399998226 -2.90103940799997417, -52.65665775099995471 -2.90099111099993934, -52.65664170099995545 -2.90097153099992511, -52.65661007299996754 -2.90092315299995107, -52.65659418599994979 -2.90090365599996858, -52.6565627639999434 -2.90085575099993775, -52.65654662099996131 -2.90083583399996314, -52.65652515599998651 -2.90080320799995661, -52.65649778199997399 -2.90076933799997505, -52.65647617899998068 -2.90073663599997644, -52.65644894199994042 -2.90070284299997638, -52.65642720299996427 -2.90067006199996058, -52.65640010099997426 -2.90063635099994599, -52.65637881599997172 -2.90060319599996319, -52.65633443299998362 -2.90053433799994309, -52.65629809999995814 -2.90048016799994457, -52.65627639699994234 -2.90044754499996316, -52.65624826599997732 -2.90041221799992854, -52.65622809999996434 -2.90038193399993816, -52.65620000499995967 -2.90034663299996964, -52.65617951799993079 -2.90031651399993962, -52.65614350499993179 -2.90026250099992922, -52.65609951299995828 -2.9001940209999475, -52.6560622369999578 -2.90013561399996433, -52.65602005599993163 -2.90001374199994189, -52.65600350199997592 -2.89994789199994329, -52.65599412299997084 -2.8999207539999361, -52.65598057199997584 -2.89986690799997859, -52.65596328299994866 -2.89981682199993429, -52.65595623199993724 -2.89978889199994683, -52.65593897299993387 -2.89973883699997259, -52.65593189099996607 -2.89971087499992564, -52.65591466299997592 -2.89966085099996462, -52.65590637499997229 -2.89962822899997263, -52.65590464799993242 -2.89960779299997284, -52.65589407899994967 -2.89954452399996399, -52.65588000099995725 -2.89937458299993978, -52.65587652899995419 -2.89916641899992555), (-52.65587652899995419 -2.89916641899992555, -52.65595604299994648 -2.89913507199997866, -52.65603141499997264 -2.89909676699994634, -52.65610667399994327 -2.89905022999994344, -52.65618104299994684 -2.89899405999994997, -52.65623211699994499 -2.89894641699993372, -52.65628213699994831 -2.89888710999997556, -52.6563317069999357 -2.89881012799997961, -52.65635370799998327 -2.89876170399998045, -52.65639540099994065 -2.89869821699994645, -52.65641855799998439 -2.89864560899997059, -52.65646427499996207 -2.89857804499996519, -52.65648338299996567 -2.89855873899995231, -52.65653439299995853 -2.89847891899995602, -52.6565780859999677 -2.89840990899995177, -52.65662338599997838 -2.89834178199993175, -52.65666964399997596 -2.89827416299993956, -52.65671590399995239 -2.8982065449999368, -52.65676216399998566 -2.89813892699993403, -52.65680396599998403 -2.89808062699995617, -52.65684776899996677 -2.89801593899994714, -52.65685905199995887 -2.89800361499993642, -52.65689562199997908 -2.89794971199995643, -52.65690681799998174 -2.89793741599993382, -52.65694543599994404 -2.89788465499992753, -52.65699323199993387 -2.89781839399995533, -52.65704102999995939 -2.89775213399997256, -52.65708882899997434 -2.89768587499997921, -52.65713493999993489 -2.89761860899994872, -52.65717879999994011 -2.89754999999996699, -52.65722265999994534 -2.89748139099992841, -52.65726602499995579 -2.89741374399994811, -52.65730747699996073 -2.89736680099997557, -52.6573595699999828 -2.89730385099994692, -52.65737864299995863 -2.89727567099993166, -52.65742108999995708 -2.8972473429999468, -52.65746117199995524 -2.89721178699994653, -52.65752475899995488 -2.89713988099993003, -52.65756389699993179 -2.89709800799994355), (-52.65587652899995419 -2.89916641899992555, -52.65579862699996738 -2.89910344499998018, -52.65573120199996993 -2.89904846699994323, -52.65566950199996654 -2.89899016599997594, -52.65561485999995739 -2.89892944799993302, -52.65556697599993186 -2.8988663349999797, -52.65552344799993989 -2.8987974469999358, -52.65549171799995065 -2.8987496479999777, -52.6554702459999362 -2.89871410799997875, -52.65544729899994536 -2.89866952399995625, -52.65543012499995257 -2.89864241599997285, -52.65539274999997588 -2.89856963099992981, -52.65538914199993314 -2.89856066499993403, -52.6553725349999695 -2.89852826299994604, -52.6553605539999694 -2.89849835699993719, -52.65533736399993359 -2.89841978599997674, -52.65531570199993894 -2.89834092899997131, -52.65529403999994429 -2.89826207299995531, -52.65527237799994964 -2.89818321599994988, -52.65524616899995181 -2.89808901999992941, -52.65523190599998316 -2.89805436299997154, -52.65521933299993407 -2.89801210299992817, -52.65518820199997663 -2.89793675899994696, -52.65517590199993947 -2.89791389999993498, -52.65515456399998584 -2.8978623349999566, -52.6551423099999738 -2.8978395089999367, -52.65512092599993821 -2.89778791099996624, -52.65510871699996187 -2.89776511799993841, -52.65508728799994742 -2.89771348699997588, -52.65507512299996051 -2.89769072699994013, -52.65505365099994606 -2.89763906199993926, -52.65502681099997062 -2.89758873999994648, -52.65501718399997344 -2.89756567499995299, -52.65498013399997035 -2.89749250199997732, -52.65495030399995358 -2.89743646399995214, -52.65493968599997743 -2.89741125899996632, -52.65490584799994167 -2.89736830699996517, -52.65488965599996618 -2.89734342699995295, -52.65483787299996266 -2.89728070999996135, -52.65478751199998442 -2.89721683399994845, -52.6547676969999543 -2.89719591799996579, -52.65475669999995034 -2.89718197399997734, -52.65470859599997766 -2.897139554999967, -52.65464775999993208 -2.89708470299996179, -52.65458838599994351 -2.89703113899997788, -52.65456008899997187 -2.89701450299997987, -52.6545036899999559 -2.8969883759999675, -52.65447833499996477 -2.89698232699993241, -52.65443566499993722 -2.89696741599993857, -52.65439141399997425 -2.89695701999994526, -52.65434763499996507 -2.89694153799996457, -52.6543106349999448 -2.89693297899992785, -52.65420547399997986 -2.89689536299994188, -52.65414197099994453 -2.89687464199994338, -52.65409784799993531 -2.89686493499993958, -52.65402148099997248 -2.89683739499997728, -52.65395708599993441 -2.89680551999992986, -52.6538706579999598 -2.89676193999997622, -52.65377488299998276 -2.89671181399995703, -52.65370578099998511 -2.89667598399995541, -52.65362179399994602 -2.89661720899994179, -52.65354860899998357 -2.89656786199992666, -52.65349195399994642 -2.89651109299995824, -52.65345668399993428 -2.89647893899996234, -52.653415349999932 -2.89644383299997799, -52.6533530799999312 -2.89639111999997567, -52.65329081099997666 -2.89633840799996278, -52.65326028499993072 -2.89631298699993067, -52.65323208299997759 -2.8962934479999376, -52.65316452899998012 -2.89624831299994412, -52.65309697499998265 -2.89620317599997179, -52.65302942099998518 -2.89615803999993204, -52.65296997199993712 -2.89611815099993919, -52.65292960099998254 -2.89609040499993853, -52.65290641799998639 -2.89607096999992564, -52.65286425899995493 -2.89604176099993538, -52.65284113799998522 -2.89602234499994893, -52.65279891799997358 -2.89599311699993223, -52.6527631109999561 -2.89596299699996962, -52.65273461299995006 -2.8959432699999752, -52.65267247499997438 -2.89589090799995574, -52.65262513899995156 -2.89584469899995156, -52.65256706099995654 -2.89578753699993285, -52.65251002899998412 -2.8957294449999722, -52.65249835299994174 -2.89571955399992476, -52.6524509049999665 -2.89567321499993113, -52.65239282699997148 -2.89561605399995869, -52.65233474899997645 -2.89555889299992941, -52.65227765199995247 -2.8955008579999344, -52.65226618799994185 -2.89549108399995703, -52.65221955799995612 -2.89544371099992759, -52.65220814699995344 -2.89543396599992775, -52.65217801199997893 -2.89540336699997169, -52.65216159499993864 -2.89539157199993724, -52.6521471269999779 -2.89538296099993886, -52.65208154499993043 -2.89533580199997687, -52.65201437899997927 -2.89528919799994355, -52.6519472139999607 -2.89524259399996708, -52.65188004999993154 -2.89519598999993377, -52.65181288599995924 -2.89514938399997845, -52.65174572299997635 -2.89510277799996629, -52.65167856099998289 -2.89505617099996471, -52.65162477299998045 -2.89501924899997221, -52.65161027999994303 -2.89501084799996988, -52.65154423899997482 -2.89496295399993642, -52.65151828999995587 -2.89494626999993443, -52.65147348699997565 -2.89492046799995251, -52.65145111299995051 -2.89490413799995849, -52.65140368299995544 -2.89487689299994599, -52.65138144999997394 -2.89486057299995991, -52.65133387699995637 -2.8948333209999646, -52.65131178699994052 -2.89481700499993622, -52.65126406999996789 -2.89478974999997263, -52.6512421259999428 -2.89477343399994425, -52.65118399999994381 -2.89474033999994163, -52.65117186999998466 -2.89473126899997624, -52.65110082599994712 -2.8946909679999635, -52.65102565799998047 -2.89466041099996119, -52.65100005299996155 -2.89465368999992734, -52.65094914499997003 -2.89463303499996982, -52.65092358099997227 -2.89462629199994126, -52.65087263199995959 -2.89460565699994277, -52.65084710899998299 -2.89459889299996576, -52.65079611899994916 -2.89457827999996198, -52.65077063699993687 -2.89457149499997968, -52.65071960599993872 -2.89455090199993492, -52.65069416399995816 -2.89454409799992618, -52.65064309299998513 -2.89452352299997528, -52.65061769199996888 -2.89451670099992953, -52.65056658099996412 -2.8944961439999588, -52.6505480239999315 -2.89449113999995689, -52.65049039799993125 -2.89446798699992769, -52.6504769219999389 -2.89446433899996691, -52.65040152299997089 -2.89443406399993819, -52.65036880999997493 -2.89441628999998102, -52.6503072619999557 -2.89439146099994105, -52.65027949699998544 -2.89437656099994456, -52.65020250099996701 -2.89434559299996863, -52.6501204039999493 -2.89432223899996188, -52.65003320499994288 -2.89430649899992432, -52.64998954499998263 -2.89430265499993311, -52.64995366499994134 -2.89430260999995426, -52.64993787399993153 -2.89430392199994913, -52.64987627799996517 -2.89430391199994119, -52.64978374299994357 -2.89428829699994594, -52.64970133599996416 -2.89427504199994701, -52.64962890799995421 -2.89426403699997081, -52.64954888299996583 -2.89424619099997926, -52.64946637699995335 -2.89422758599994268), (-52.64786319899997125 -2.89496318199996949, -52.64796445099995026 -2.89497300199997198, -52.64807003799995755 -2.89498261799997181, -52.64817281299997376 -2.89499124799993979, -52.64819406899994192 -2.89498982799995019, -52.64826833299997588 -2.8949743309999576, -52.6483074289999422 -2.89496525799995652, -52.64837430599993695 -2.89495927899997696, -52.64841006399996104 -2.89494757399995706, -52.64844312599996101 -2.89493080499994448, -52.64848485399994615 -2.89491608599996653, -52.6485179019999805 -2.89489931099996056, -52.64855964399993127 -2.89488459799997599, -52.64859267899993256 -2.89486781699997664, -52.64863443399997323 -2.89485310999992862, -52.64869942399997171 -2.89482138099992881, -52.6487755539999398 -2.89478342299997848, -52.64884843099997624 -2.89474743999994644, -52.64892151599997305 -2.89471182899995938, -52.64900348399993391 -2.89467023499997822, -52.64907208799996852 -2.89462402999993174, -52.64913920499998312 -2.89457427599995754, -52.64920355199996038 -2.89451791299995875, -52.64934159899996757 -2.89436914299994896, -52.64937258999998448 -2.894329794999976, -52.64946637699995335 -2.89422758599994268), (-52.64946637699995335 -2.89422758599994268, -52.64943855699993946 -2.89416857899993829, -52.64939487499998449 -2.89408580599996412, -52.6493631229999437 -2.89402683999998089, -52.6493183849999582 -2.89395283699997208, -52.64918301699998437 -2.8937291839999375, -52.6491390859999342 -2.89366028999995706, -52.64909643099997538 -2.89359072799993555, -52.64905377699994915 -2.89352116499992462, -52.64902228899995862 -2.89345622199994068, -52.64897818799994411 -2.89335756099995933, -52.6489435819999585 -2.89328345799992803, -52.64893036299997675 -2.89326137799997696, -52.64890643799998315 -2.89321027499994443, -52.64889086799996676 -2.89318417599997701, -52.64885581899994804 -2.89310951999993904, -52.64884443699997973 -2.89307765599994582, -52.64882358799997064 -2.89303292199997486, -52.64880246899997474 -2.89297396399996387, -52.6487971859999675 -2.89295369799992841, -52.648790584999972 -2.89291445499992506, -52.64877965199997334 -2.89287225499992928, -52.6487729699999818 -2.89283295099994575, -52.64876211599994349 -2.89279081199993016, -52.64875535699997045 -2.89275144599997702, -52.64873447499996928 -2.89266994199994087, -52.64870670299995936 -2.89258843999994042, -52.64867204099994069 -2.89250693799993996, -52.64865855099998271 -2.89248047899997118), (-52.64226263199998357 -2.8928540249999628, -52.6423012259999723 -2.892848148999974, -52.64232712499995159 -2.89283588399996461, -52.64235832899993284 -2.89281234899993933, -52.64239701399998239 -2.89279074299997774, -52.64246229299993729 -2.89274101999995992, -52.64247183499998073 -2.89273122999992438, -52.64252609399994753 -2.89268982699996968, -52.64255383499994423 -2.89266102799996361, -52.64258701999995083 -2.89263577499997382, -52.64261467999995148 -2.89260696699994924, -52.64264794699994354 -2.89258172399996738, -52.6426755239999693 -2.89255290499994544, -52.64270887499998253 -2.89252767399995037, -52.64276498299994955 -2.89246883199996319, -52.64280202399993414 -2.89243389099993919, -52.64283719199994493 -2.89238223899997138, -52.64288597999996 -2.89231695299997682, -52.64293476699998564 -2.89225166599993599, -52.64297110699993709 -2.89220477099996742, -52.6429868059999535 -2.89218853499994566, -52.64301988499994422 -2.89213953099994114, -52.64303566199993156 -2.89212329499997622, -52.64308111499997267 -2.89205579799994439, -52.64308495499994933 -2.89204705299994203, -52.64312469799995142 -2.89198706199994149, -52.64315746499994475 -2.89191115599993509, -52.64317122799997151 -2.89185503499993501, -52.64318185499996616 -2.89182969899997033, -52.64319592199996123 -2.89177352299992663, -52.6432062649999466 -2.89174825499992494, -52.64322059299996681 -2.89169201199996451, -52.6432306909999852 -2.89166682099994432, -52.64324524699998165 -2.89161050099994554, -52.64325512999994316 -2.89158539599992537, -52.64331167799997502 -2.89136925399992606), (-52.64865855099998271 -2.89248047899997118, -52.64871100799996384 -2.89243090599995867, -52.64872408399997994 -2.89241593899993177, -52.64873926999996456 -2.89240101099994718, -52.64880513499997505 -2.89232520099994872, -52.64882103799993729 -2.89230996099996673, -52.64888618599997017 -2.89223436499997888, -52.64890297199997349 -2.89221889299994928, -52.64892446999994036 -2.89219361799996477, -52.64898200099997894 -2.89210467199995946, -52.64906047899995656 -2.89198844799994959), (-52.64865855099998271 -2.89248047899997118, -52.64855288599994765 -2.89245020299995304, -52.64845434899996235 -2.89244303499992839, -52.64840117799997188 -2.8924400199999809, -52.64834617399998251 -2.89244118999994271, -52.64826269399998182 -2.89244972799997413, -52.64823032699996475 -2.89245582499995635, -52.64814816299997347 -2.89246412499994676, -52.64810774099993296 -2.89246461999994153, -52.64807987299997194 -2.89246468099997855, -52.64799701799995546 -2.89245802599992885, -52.6479165169999419 -2.89244378499995491, -52.6478362279999601 -2.89242886299996371, -52.64778648799995153 -2.89241933499994275, -52.64774937399994315 -2.89240464799996744, -52.64771118199996636 -2.89239396299996088, -52.64766993899996805 -2.89237749999995231, -52.64764275499993573 -2.89237140399995951, -52.64753480099994931 -2.8923654419999707, -52.64743938999993134 -2.89236195699993459, -52.64735427299996218 -2.89234311099994557, -52.64728831399997944 -2.89231528999994225, -52.64727681599993048 -2.89231283099996972, -52.64720100199997432 -2.89228009899994731, -52.64712567299994816 -2.8922466439999539, -52.64705034199994316 -2.89221319099993934, -52.64702744099997744 -2.89219561899994915, -52.64696527299997797 -2.89216912899996714, -52.64695101299997759 -2.89215806499993278, -52.64688473899997234 -2.89212996099996644, -52.64681100399997149 -2.8920960679999439, -52.64673666499993487 -2.89206345399998099, -52.646660327999939 -2.89203506299998025, -52.64658399699993652 -2.89200665999993589, -52.64650767199998427 -2.89197824399997216, -52.64643161599997256 -2.89194925999993302, -52.646409197999958 -2.89192903999997952, -52.64636147899994967 -2.89190775999998095, -52.64633883599998398 -2.89188778799996271, -52.64629133399995453 -2.89186627699996279, -52.64626808399998481 -2.89184617599994453, -52.64621497399997452 -2.89183793599994488, -52.64611062199998059 -2.89181667399992648, -52.64601392299994131 -2.89180505499996343, -52.64593286699994223 -2.89180151299996169, -52.64585181199993258 -2.89179796099995201, -52.64577075699997977 -2.89179439699995555, -52.64568970399994896 -2.89179081999992604, -52.64561720299997205 -2.89178768099992567, -52.64560842299994192 -2.89178996299995106, -52.6455347619999543 -2.89177828799995496, -52.64546099199998253 -2.89176746899994441, -52.64540769499996031 -2.89174495899993644, -52.64529857299993409 -2.89166467199993349, -52.64524379799996723 -2.89162711199998057, -52.64517932599994765 -2.89160028599997077, -52.64516652199995406 -2.89159787199997709, -52.64510137399997802 -2.89157363099997156, -52.64502470499996889 -2.89154463699992448, -52.64497083499998098 -2.89152258499996151, -52.64491557599995986 -2.89150695099993982, -52.64483706299995447 -2.89148639999996249, -52.64475757899998598 -2.89146949899992478, -52.64468026699995562 -2.89143831799992768, -52.64465236199993114 -2.89142085199995336, -52.64460735399995883 -2.89140267299995912, -52.64456465999995771 -2.89137586499992949, -52.64453586199994106 -2.89136419999994132, -52.64449313399995845 -2.89133741199992755, -52.64446436999998014 -2.89132572699998036, -52.64438568299993904 -2.89127393599994775, -52.64432722199995851 -2.8912371679999751, -52.64430249299994102 -2.89121535399993945, -52.64426066799995851 -2.89118886999995084, -52.64423355399998172 -2.89116519199995992, -52.64413743599993722 -2.89110389699993675, -52.64405481299996836 -2.89106570499995996, -52.64392887599996129 -2.89102476699997624, -52.64388388099996519 -2.89100562299995545), (-52.64331167799997502 -2.89136925399992606, -52.64322704199997816 -2.89132271899995885, -52.64314596999997775 -2.89128834099994947, -52.64307624899993243 -2.89126754599993774, -52.6429870539999456 -2.89120171799993386, -52.64290554099994779 -2.8911429279999652, -52.64284285799993768 -2.89107789199994158, -52.64277415799995197 -2.8910026689999313, -52.6427056159999438 -2.89095743199993649, -52.64263299899994308 -2.89092111499996918, -52.64259927099993774 -2.89091602999997122, -52.64258606099997451 -2.89091791099997408, -52.64255549299997483 -2.89091281099996422, -52.64254106199996386 -2.89091504799995391, -52.64250193599997374 -2.89093466099996022, -52.64248394299994516 -2.89093609199994717, -52.64241467999994484 -2.8909742729999266, -52.64239076299998032 -2.89096970599996439), (-52.64388388099996519 -2.89100562299995545, -52.6437777829999618 -2.89110038499995881, -52.64371214999994208 -2.89114845699992884, -52.64364271999994571 -2.89119059499995501, -52.64357328999994934 -2.89123273299992434, -52.64350346199995556 -2.89127424899993457, -52.6434335149999697 -2.89131557999996858, -52.64334289799995759 -2.89135799999996834, -52.64331167799997502 -2.89136925399992606), (-52.64388388099996519 -2.89100562299995545, -52.64388721699998541 -2.89092332499996019, -52.64389176699995687 -2.89088690899995981, -52.64389355699995576 -2.89079507999997531, -52.64388971199997513 -2.8907560349999244, -52.64389083599996866 -2.8907054939999739, -52.64387786699995786 -2.89058762699994531, -52.64387983999995413 -2.89053702599994722, -52.64387632599994049 -2.89050521199993682, -52.64388051599996743 -2.89041321899992454, -52.64388594599995486 -2.89032986399996616, -52.64389105499998323 -2.89026052799994204, -52.64389923199996701 -2.89022238199993353, -52.64390423999998347 -2.8901523439999437, -52.64390917899993383 -2.8900661089999744, -52.64391390699995554 -2.88998460099998056, -52.64390494399998488 -2.88995185899995022, -52.64389135199996872 -2.88990309699994441, -52.64388781799993922 -2.88986758499993357, -52.64386631199994326 -2.88979192599992984, -52.64384250499995233 -2.88970061099996656, -52.64383117599993511 -2.88967847599997185, -52.64381544599996232 -2.88962376799997855, -52.64380780999994158 -2.88960888099995827, -52.64380145099994479 -2.8895868029999292, -52.64379785299996684 -2.88954339399992932, -52.64378657199995359 -2.88950529799996048, -52.64378330699997832 -2.8894618829999672, -52.64376172499993345 -2.88939126699995086, -52.64373018899993895 -2.88927204899994194, -52.64370901999996022 -2.88919072199996663, -52.64369811099993512 -2.88915507999996635, -52.64369466699997702 -2.88911406999994824, -52.64369014299995797 -2.88905091699996319))"
poligono_wkt = "POLYGON((-52.64347904612947104 -2.89080546616306933,-52.6432705349814043 -2.89092530823861038,-52.64294284460241613 -2.8909253608932941,-52.64261513050085739 -2.89077565279650939,-52.64246618509287856 -2.8908056287615711,-52.64232054413938755 -2.89101070447736408,-52.64264790257611537 -2.89105553380703428,-52.64279340536044316 -2.89149418410602754,-52.64291315441140995 -2.89155436037776248,-52.64291317342924259 -2.89167416890231621,-52.64291321146487235 -2.89191378596127802,-52.64258558239233565 -2.89230321623145015,-52.64231750481440031 -2.8925129240697216,-52.64207919829864579 -2.89260281853288914,-52.64184092476683219 -2.89290237790642424,-52.64184095939648955 -2.89312235997971579,-52.64190347734616893 -2.8931223500213723,-52.64242183279159804 -2.8931701907308347,-52.64299371154209695 -2.89259501800387753,-52.64356554371079255 -2.89173230448131724,-52.64408979509870079 -2.8913967559441498,-52.64466181026062941 -2.8916842037013053,-52.64551979495904988 -2.89187575757647863,-52.64609177200026124 -2.89192358732569454,-52.64690212439081307 -2.89230684136140725,-52.64761716488932564 -2.89278595733930066,-52.6480223308772608 -2.89291168907901453,-52.64828448770504821 -2.8929356071815997,-52.64840369155557909 -2.89319916619536466,-52.64861823176531175 -2.89351063271034903,-52.64885662799832744 -2.89396586551241963,-52.64884478126948153 -2.89438519757301238,-52.6485230773079067 -2.89456496418388243,-52.64816561910994608 -2.89470879405114578,-52.64780817850009242 -2.89496045152875903,-52.64805845728611189 -2.89521200805473988,-52.64841595125128748 -2.89528383370069831,-52.64898788104597571 -2.8950321401305037,-52.64941682967326386 -2.89485235534792373,-52.64988155025352512 -2.89481633465355515,-52.64995161951559766 -2.89483257998658683,-52.65018245749273262 -2.89472809126933894,-52.65045058395048017 -2.89481790247297699,-52.65095704183535474 -2.89496757753954537,-52.65185087822703025 -2.89574618165019704,-52.65268512556615832 -2.89646489088631531,-52.65319162042398915 -2.89682422988493737,-52.65337038221090893 -2.89694400778345784,-52.65375767570807142 -2.89706374967206237,-52.65405559858371731 -2.89718350685891934,-52.65429394618083592 -2.89733322644137514,-52.6545025190260958 -2.89757280764172442,-52.65468130686601711 -2.89784234615143399,-52.65486010511688875 -2.89817178898773031,-52.65494955841801072 -2.8986510082454231,-52.6550687711669454 -2.89895050928236353,-52.6551879685066524 -2.89916015378165692,-52.65539656269219648 -2.89951954359428576,-52.65542639437729378 -2.89975915586035127,-52.65554560743148471 -2.9000586569049136,-52.65563503021854785 -2.90035816315868855,-52.65578402341262887 -2.90059775462453073,-52.65605219371017398 -2.90092718177951081,-52.65670769122903749 -2.9015560627624688,-52.65706522289054448 -2.90182556955584436,-52.65721421147763692 -2.90203520865926379,-52.65736322107521517 -2.90236465654746478,-52.65736326295716196 -2.90260427415795252,-52.65739309526777134 -2.902843886516838,-52.65754208409985893 -2.90305352561079388,-52.65775064339026557 -2.90320324972601496,-52.65795920275001407 -2.90335297379738222,-52.65807840134548456 -2.90356261810744654,-52.65807843815877476 -2.90377228356994443,-52.65801890981055067 -2.904071816248043,-52.65784018274775491 -2.90416170457904554,-52.65763165992970585 -2.90422164593645782,-52.65742314755842557 -2.90434149167156974,-52.65703591313549481 -2.90458117775324842,-52.65667850548794604 -2.90503052395659278,-52.65655936952612137 -2.90518030600230137,-52.65655942161127712 -2.90547982819756712,-52.65661902869565836 -2.90562957882675299,-52.65685736329987066 -2.90568944132753293,-52.65697649927950863 -2.90553965922609114,-52.65721478158036462 -2.90529999942745665,-52.6577509372863517 -2.90488057355764484,-52.65819775262396973 -2.90464087656901659,-52.65846584592993196 -2.9045210200453524,-52.65879354125642209 -2.90452096167900908,-52.65906168207315119 -2.90467067490887532,-52.65930006958287635 -2.90503005891035793,-52.65941926871273182 -2.90523970311634239,-52.65965769369690008 -2.90580875261889426,-52.65974712373763111 -2.90613821105292391,-52.65980674734560552 -2.90637781816734897,-52.65995575861047939 -2.90670726592743245,-52.66013454456950171 -2.90694685163956512,-52.66031334129064589 -2.90724634179093488,-52.66043255162454528 -2.9075158904266365,-52.66046236889975063 -2.90766564622941814,-52.66061135390102521 -2.90784533278977575,-52.66064117656122789 -2.90802504083350222,-52.6605816327573848 -2.90823471723965499,-52.66046249702088744 -2.90838449990926717,-52.66031355996098995 -2.90847438345096299,-52.66019441348925056 -2.90856426161225512,-52.66007527764472229 -2.90871404424054525,-52.66007531492326876 -2.90892370993282601,-52.66016471345535876 -2.90907345507921855,-52.66037326390555506 -2.90916327428373567,-52.66058181973974683 -2.90928304568620621,-52.66073077294861093 -2.90928301881713613,-52.66090949003307031 -2.90913322531985763,-52.66105841642607288 -2.90898343717996388,-52.66126694011884268 -2.9089234949596694,-52.66150525441165797 -2.90886354728937135,-52.66171376728686937 -2.90874370048259268,-52.66186268809677529 -2.90856395998033035,-52.66207120085505267 -2.9084441130976586,-52.66219035251925362 -2.90838418692710787,-52.66233927857535946 -2.9082343985967225,-52.66257758720559679 -2.90814449841056133,-52.66272654022618838 -2.90814447120771202,-52.66278609435589431 -2.90799469913482023,-52.66275627126866965 -2.90781499116414821,-52.66269665219324736 -2.9076053364076091,-52.66239872471943784 -2.9074855818444405,-52.6621306040849575 -2.90745567845966812,-52.66186247808330023 -2.90739582276218478,-52.66165392251588173 -2.90727605170783354,-52.66147516294748243 -2.907186227438046,-52.66126660211504884 -2.90703650406800573,-52.66108784263285969 -2.90694667972514953,-52.66087928727258571 -2.90682690850126679,-52.66058121071305465 -2.90586849103263223,-52.66034276912610324 -2.90520958511288985,-52.66019374197923497 -2.90479028087385949,-52.65959779406716024 -2.90401163028864095,-52.65912105659591447 -2.90350252801539188,-52.65894223986391864 -2.90308322904151783,-52.65882304641442602 -2.90290353707192761,-52.6585549167133351 -2.90281372823319517,-52.65834635737954272 -2.9026640043187486,-52.65819737368763498 -2.90248431757788206,-52.6580186101584502 -2.90236454050550874,-52.65778025536085494 -2.90218486955877442,-52.65769084741698691 -2.90197521999628583,-52.65748223602916767 -2.90152597394484735,-52.65742263431001646 -2.90140617569906079,-52.65730345708557536 -2.90131634017174012,-52.65712469390724237 -2.90119656294997519,-52.65703527576561527 -2.90092700898287914,-52.65691606732117691 -2.90065746027176763,-52.65670746183857176 -2.90023816635290022,-52.65646907663268905 -2.89987878202583005,-52.65637963800827492 -2.8994894193396199,-52.65646897772864321 -2.89930969055354604,-52.65658809209094926 -2.89904009998992906,-52.65661783028951248 -2.89874057296961762,-52.65679653031646268 -2.89850092410747617,-52.65739221558481375 -2.89781191902372548,-52.65771982451617106 -2.89733262633725719,-52.65777935776753083 -2.89706304627830624,-52.65768996082464071 -2.8969133012769599,-52.65757079465264212 -2.89688337020194719,-52.65721333279527983 -2.89700324204001092,-52.6570048377099198 -2.89721294399356477,-52.65655811428433708 -2.89796182690183901,-52.65631987015420634 -2.89841115136917837,-52.65620073500875975 -2.89856093315422925,-52.65611137453480239 -2.89862085317674856,-52.65593262242541783 -2.89856098013692254,-52.6557538392498472 -2.89832139401139743,-52.65533657896614272 -2.89718328435756023,-52.65506841004562943 -2.89685385725250155,-52.65477047169745362 -2.89664424392087572,-52.65456192984812134 -2.89658437580779937,-52.65432360807509582 -2.8965844171355184,-52.65414486161716212 -2.89655449592628234,-52.65396609980437148 -2.8964347181933694,-52.65378731757434139 -2.89619513178295573,-52.6535489550378486 -2.89595555562286,-52.65331060792924234 -2.8958058358857417,-52.65298288014826511 -2.89559622713077403,-52.65247635055624897 -2.89502722303100235,-52.65170173547706867 -2.89460802517259186,-52.65056962939205221 -2.89412898289180909,-52.65021210772883364 -2.89388942608374444,-52.6498546012120201 -2.8937397255780648,-52.64952687498763595 -2.89353011564533169,-52.64937788959795739 -2.89332047564072825,-52.64925867452194552 -2.89299102206593339,-52.64925862486632724 -2.8926915006747298,-52.64925857521075869 -2.8923919793031474,-52.64922874044680867 -2.8921224150772642,-52.64913933053207273 -2.89188281297804561,-52.64881163980492573 -2.89188286779203763,-52.64848394907784268 -2.89188292248556866,-52.64824563841262517 -2.89194286645353715,-52.64800733263975019 -2.89203276249139529,-52.64756047666460859 -2.89200288450639809,-52.64735196578250509 -2.89212272756865163,-52.64711363540182276 -2.89206286269862378,-52.64684550521199213 -2.89194309841094999,-52.64651779983977065 -2.89185329598188057,-52.64630924504664478 -2.89170356960271535,-52.64598155438456928 -2.89170362337548914,-52.64568365378266179 -2.89170367215538571,-52.64547511852163098 -2.89167375411014715,-52.64538571932380506 -2.89149405591761299,-52.645057999783198 -2.89131439657210398,-52.64476008486236225 -2.89122458865637899,-52.64455153531613973 -2.89110481401365194,-52.64440256109417504 -2.89095507753992154,-52.64428337695225224 -2.89080533622013736,-52.6442237776991675 -2.89068553736892531,-52.64413437884918778 -2.89050583908939318,-52.64413434528367475 -2.89029617422676433,-52.64417384544096024 -2.88995812680673891,-52.64408714978565484 -2.88975897419094352,-52.64390833320978658 -2.88927976921031382,-52.64384961874119995 -2.88888663952420943,-52.64359789573152426 -2.88885855918735057,-52.6435085497045776 -2.88900833416126801,-52.64350857835006536 -2.88918804684981056,-52.64359798649869759 -2.88942764937327423,-52.6435980199392759 -2.88963731419677394,-52.64365762859825537 -2.88981701730145746,-52.64365768594880279 -2.89017644274911545,-52.64359817758786875 -2.89062573420638147,-52.64347904612947104 -2.89080546616306933))"

linha = loads(linha_wkt)
geometria = linha.boundary
print geometria.wkt

lines = list(linha)
Id = 0
dict_linha = {}
for line in lines:
    dict_linha[Id] = {
        "linha":line,
        "pt1Id":None,
        "pt2Id":None
    }
    Id += 1

endpts = [(shapely.geometry.Point(list(line.coords)[0]), shapely.geometry.Point(list(line.coords)[-1])) for line  in lines]

endpts = [pt for sublist in endpts  for pt in sublist]
inters = []
for line1,line2 in  itertools.combinations(lines, 2):
  if  line1.intersects(line2):
    inter = line1.intersection(line2)
    if "Point" == inter.type:
        inters.append(inter)

point_ends = shapely.ops.unary_union(endpts)
point_inters = shapely.ops.unary_union(inters)
point_result = point_ends.difference(point_inters)

def cortar_conexoes(poligono, linha, lista_pontos, raio = 0.005):

    lista_polysCortar = []
    for ponto in lista_pontos:
        circulo = ponto.buffer(0.0001)
        polyConex = circulo.intersection(linha).buffer(0.000005)
        bordaCirculo = circulo.boundary
        circunDividida = bordaCirculo.difference(polyConex)
        linhas_merge = shapely.ops.linemerge(circunDividida)
        lista_linhas = list(linhas_merge)
        funcCirculoBorda = PtCircBorda(ponto.x, ponto.y)
        lista_linhasm = []
        for linha_part in lista_linhas:
            pt1x = linha_part.coords[0][0]
            pt1y = linha_part.coords[0][1]
            pt2x = linha_part.coords[-1][0]
            pt2y = linha_part.coords[-1][1]

            ptx_m, pty_m, ptx_inv, pty_inv = funcCirculoBorda.retorna_pontos_metade_entre_vetores(
              pt1x, pt1y, pt2x, pt2y, raio
            )
            linha_metade = shapely.geometry.LineString([[ponto.x, ponto.y], [ptx_m, pty_m]])
            linham_poly_final= None
            linham_poly = linha_metade.intersection(poligono)
            if linham_poly.type != "LineString":
                for linham in list(linham_poly):
                    if linham.intersects(circulo):
                        linham_poly_final = linham
            else:
                linham_poly_final = linham_poly
            lista_linhasm.append(linham_poly_final)
            pass
        linhasm_unidas = shapely.ops.unary_union(lista_linhasm)
        polyCortador = linhasm_unidas.buffer(0.000005)
        lista_polysCortar.append(polyCortador)
    polyCortarUnido = shapely.ops.unary_union(lista_polysCortar)
    poligonos_separados = poligono.difference(polyCortarUnido)
    return poligonos_separados

def PontosInterFim(linha):
    lines = list(linha)
    endpts = [(shapely.geometry.Point(list(line.coords)[0]), shapely.geometry.Point(list(line.coords)[-1])) for line  in lines]
    endpts = [pt for sublist in endpts  for pt in sublist]
    inters = []
    for line1,line2 in  itertools.combinations(lines, 2):
      if  line1.intersects(line2):
        inter = line1.intersection(line2)
        if "Point" == inter.type:
            inters.append(inter)

    point_todos = shapely.ops.unary_union(endpts)
    point_inter = shapely.ops.unary_union(inters)
    point_fim = point_ends.difference(point_inters)
    return point_todos, point_inter, point_fim

def indetiLinePoly(poligonos, linhas):
    listaLinhaPoligono = []
    for poligono in list(poligonos):
        prepared_poligono= shapely.prepared.prep(poligono)
        hits = filter(prepared_poligono.intersects, linhas)
        linha_part = hits[0]
        listaLinhaPoligono.append([linha_part, poligono])
    return listaLinhaPoligono

poligono = loads(poligono_wkt)
poligonos_separados = cortar_conexoes(poligono, linha, point_inters)
indetiLinePoly(poligonos_separados, linha)
